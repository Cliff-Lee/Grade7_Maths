<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MYP Mathematics Criterion B Investigation: Mystic Rings Puzzle</title>
  <style>
    /* Inline CSS Styling */
    body {
      font-family: Arial, sans-serif;
      background-color: #eef2f3;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #00539CFF;
      color: #FFFFFF;
      padding: 20px;
      text-align: center;
    }

    main {
      padding: 20px;
    }

    h1, h2, h3 {
      color: #333333;
    }

    h1 {
      margin-top: 0;
    }

    #game-section, #investigation-section {
      margin-bottom: 40px;
    }

    #game {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }

    .tower {
      width: 120px;
      height: 300px;
      margin: 0 10px;
      border: 2px solid #333;
      position: relative;
      background-color: #fff;
    }

    .tower::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 10px;
      height: 100%;
      background-color: #333;
    }

    .ring {
      position: absolute;
      height: 20px;
      background-color: #ffcc00;
      border: 1px solid #cc9900;
      cursor: grab;
      border-radius: 4px;
    }

    .ring:active {
      cursor: grabbing;
    }

    #controls {
      text-align: center;
      margin-top: 20px;
    }

    #controls p {
      font-size: 18px;
    }

    #controls button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin: 5px;
    }

    #difficulty {
      text-align: center;
      margin-top: 20px;
    }

    #difficulty label {
      font-size: 16px;
      margin-right: 10px;
    }

    #difficulty select {
      padding: 5px;
      font-size: 16px;
    }

    table {
      width: 100%;
      max-width: 600px;
      margin: 0 auto 20px;
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid #333;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    input[type="number"] {
      width: 100%;
      padding: 5px;
      box-sizing: border-box;
    }

    #checkAnswers {
      display: block;
      margin: 0 auto 20px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    .feedback {
      text-align: center;
      font-weight: bold;
      margin-bottom: 20px;
    }

    footer {
      background-color: #00539CFF;
      color: #FFFFFF;
      text-align: center;
      padding: 10px;
    }
  </style>
</head>
<body>
  <header>
    <h1>MYP Mathematics Criterion B Investigation: Mystic Rings Puzzle</h1>
  </header>
  <main>
    <section id="introduction-section">
      <h2>Introduction</h2>
      <p>
        The <strong>Mystic Rings Puzzle</strong> is an ancient challenge that involves transferring a stack of rings from one pillar to another. The puzzle consists of three pillars and a number of rings of different sizes, which can slide onto any pillar. The rings start stacked in ascending order of size on one pillar, with the smallest at the top, forming a conical shape.
      </p>
      <p>
        The objective is to move the entire stack to another pillar, following these rules:
      </p>
      <ol>
        <li>Only one ring can be moved at a time.</li>
        <li>Each move involves taking the upper ring from one of the stacks and placing it on top of another stack or on an empty pillar.</li>
        <li>No ring may be placed on top of a smaller ring.</li>
      </ol>
    </section>

    <section id="game-section">
      <h2>Interactive Mystic Rings Puzzle</h2>
      <div id="difficulty">
        <label for="ringNum">Select Number of Rings:</label>
        <select id="ringNum">
          <option value="3">3 Rings</option>
          <option value="4">4 Rings</option>
          <option value="5">5 Rings</option>
          <option value="6">6 Rings</option>
          <option value="7">7 Rings</option>
        </select>
        <button id="startGame">Start Game</button>
      </div>
      <div id="game">
        <div class="tower" id="tower1"></div>
        <div class="tower" id="tower2"></div>
        <div class="tower" id="tower3"></div>
      </div>
      <div id="controls">
        <p>Moves: <span id="moveCount">0</span></p>
        <button id="reset">Reset Game</button>
      </div>
    </section>

    <section id="investigation-section">
      <h2>Investigation</h2>
      <p>
        Use the interactive puzzle above to complete the table below. For each number of rings, record the minimum number of moves required to solve the puzzle.
      </p>
      <table>
        <thead>
          <tr>
            <th>Number of Rings (n)</th>
            <th>Minimum Number of Moves</th>
          </tr>
        </thead>
        <tbody id="movesTable">
          <tr>
            <td>1</td>
            <td><input type="number" min="1" id="move1"></td>
          </tr>
          <tr>
            <td>2</td>
            <td><input type="number" min="1" id="move2"></td>
          </tr>
          <tr>
            <td>3</td>
            <td><input type="number" min="1" id="move3"></td>
          </tr>
          <tr>
            <td>4</td>
            <td><input type="number" min="1" id="move4"></td>
          </tr>
          <tr>
            <td>5</td>
            <td><input type="number" min="1" id="move5"></td>
          </tr>
          <tr>
            <td>6</td>
            <td><input type="number" min="1" id="move6"></td>
          </tr>
          <tr>
            <td>7</td>
            <td><input type="number" min="1" id="move7"></td>
          </tr>
        </tbody>
      </table>
      <button id="checkAnswers">Check Answers</button>
      <div id="feedback" class="feedback"></div>
      <h3>Patterns Observed</h3>
      <p>
        Describe any patterns you observe in the relationship between the number of rings and the minimum number of moves required. Reflect on how the number of moves changes as the number of rings increases.
      </p>
      <!-- Open question without input box -->
      <h3>Verification and Justification</h3>
      <p>
        Verify the pattern you've observed. Explain, prove, or justify why this pattern holds true for the Mystic Rings Puzzle. Use mathematical reasoning to support your explanation.
      </p>
      <!-- Open question without input box -->
    </section>
  </main>
  <footer>
    &copy; 2023 MYP Mathematics Investigation
  </footer>

  <script>
    // Inline JavaScript Functionality
    let selectedRing = null;
    let moveCount = 0;
    let numRings = 3; // Default to 3 rings
    const towers = document.querySelectorAll('.tower');
    const moveCounter = document.getElementById('moveCount');
    const resetButton = document.getElementById('reset');
    const startButton = document.getElementById('startGame');
    const ringSelect = document.getElementById('ringNum');
    const checkAnswersButton = document.getElementById('checkAnswers');
    const feedbackDiv = document.getElementById('feedback');

    function initGame() {
      moveCount = 0;
      moveCounter.textContent = moveCount;
      towers.forEach(tower => tower.innerHTML = '');
      createRings(numRings);
    }

    function createRings(n) {
      const tower = document.getElementById('tower1');
      const towerWidth = 120; // Width of the tower
      const poleWidth = 10;   // Width of the pole
      const maxRingWidth = towerWidth - 20; // Maximum ring width (leaving some margin)
      const minRingWidth = 30;  // Minimum ring width
      const ringWidthIncrement = (maxRingWidth - minRingWidth) / (n - 1 || 1);

      for (let i = n; i > 0; i--) {
        const ring = document.createElement('div');
        ring.classList.add('ring');
        ring.dataset.size = i;
        const ringWidth = minRingWidth + (i - 1) * ringWidthIncrement;
        ring.style.width = `${ringWidth}px`;
        // Center the ring over the pole
        const leftPosition = (towerWidth - ringWidth) / 2;
        ring.style.left = `${leftPosition}px`;
        ring.style.bottom = `${(n - i) * 22}px`;
        ring.draggable = true;
        ring.addEventListener('dragstart', dragStart);
        ring.addEventListener('dragend', dragEnd);
        tower.appendChild(ring);
      }
    }

    function dragStart(e) {
      selectedRing = e.target;
      setTimeout(() => {
        e.target.style.visibility = 'hidden';
      }, 0);
    }

    function dragEnd(e) {
      e.target.style.visibility = 'visible';
    }

    towers.forEach(tower => {
      tower.addEventListener('dragover', dragOver);
      tower.addEventListener('drop', dropRing);
    });

    function dragOver(e) {
      e.preventDefault();
    }

    function dropRing(e) {
      e.preventDefault();
      const tower = e.currentTarget;
      const topRing = tower.lastElementChild;
      if (!topRing || Number(selectedRing.dataset.size) < Number(topRing.dataset.size)) {
        tower.appendChild(selectedRing);
        selectedRing.style.bottom = `${(tower.childElementCount - 1) * 22}px`;
        // Center the ring over the pole
        const towerWidth = 120;
        const ringWidth = selectedRing.offsetWidth;
        const leftPosition = (towerWidth - ringWidth) / 2;
        selectedRing.style.left = `${leftPosition}px`;
        moveCount++;
        moveCounter.textContent = moveCount;
        selectedRing = null;
        checkWinCondition();
      } else {
        alert('Invalid move! You cannot place a larger ring on a smaller one.');
        selectedRing.style.visibility = 'visible';
        selectedRing = null;
      }
    }

    function checkWinCondition() {
      const tower3 = document.getElementById('tower3');
      if (tower3.childElementCount === numRings) {
        setTimeout(() => {
          alert(`Congratulations! You solved the puzzle in ${moveCount} moves.`);
        }, 10);
      }
    }

    resetButton.addEventListener('click', initGame);

    startButton.addEventListener('click', () => {
      numRings = Number(ringSelect.value);
      initGame();
    });

    checkAnswersButton.addEventListener('click', checkAnswers);

    function checkAnswers() {
      const correctMoves = [];
      for (let i = 1; i <= 7; i++) {
        correctMoves[i] = Math.pow(2, i) - 1;
      }
      let allCorrect = true;
      for (let i = 1; i <= 7; i++) {
        const userInput = document.getElementById(`move${i}`).value;
        if (Number(userInput) === correctMoves[i]) {
          document.getElementById(`move${i}`).style.borderColor = 'green';
        } else {
          document.getElementById(`move${i}`).style.borderColor = 'red';
          allCorrect = false;
        }
      }
      if (allCorrect) {
        feedbackDiv.textContent = 'All answers are correct!';
        feedbackDiv.style.color = 'green';
      } else {
        feedbackDiv.textContent = 'Some answers are incorrect. Please check the highlighted fields.';
        feedbackDiv.style.color = 'red';
      }
    }

    // Initialize the game on page load
    window.onload = initGame;
  </script>
</body>
</html>
